<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alt Text Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        input[type="url"] {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="url"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
        }

        button {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .clear-btn {
            background: #f5f5f5;
            color: #333;
        }

        .clear-btn:hover {
            background: #e0e0e0;
        }

        .preview-section {
            margin-bottom: 30px;
            display: none;
        }

        .preview-section.active {
            display: block;
        }

        .image-preview {
            width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
        }

        .result-section {
            display: none;
        }

        .result-section.active {
            display: block;
        }

        .alt-text-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .alt-text-content {
            color: #333;
            line-height: 1.6;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .copy-btn {
            background: #4caf50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: #45a049;
        }

        .copy-btn.copied {
            background: #2196F3;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #c62828;
        }

        .error.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üñºÔ∏è Alt Text Generator</h1>
        <p class="subtitle">Generate accessible alt text for images using AI</p>

        <div class="input-group">
            <label for="imageUrl">Image URL</label>
            <input type="url" id="imageUrl" placeholder="https://example.com/image.jpg" />
        </div>

        <div class="button-group">
            <button class="generate-btn" id="generateBtn">Generate Alt Text</button>
            <button class="clear-btn" id="clearBtn">Clear</button>
        </div>

        <div class="error" id="error"></div>

        <div class="preview-section" id="previewSection">
            <img id="imagePreview" class="image-preview" alt="Preview" />
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing image...</p>
        </div>

        <div class="result-section" id="resultSection">
            <label>Generated Alt Text:</label>
            <div class="alt-text-box">
                <div class="alt-text-content" id="altText"></div>
                <button class="copy-btn" id="copyBtn">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <script>
        const imageUrlInput = document.getElementById('imageUrl');
        const generateBtn = document.getElementById('generateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const imagePreview = document.getElementById('imagePreview');
        const previewSection = document.getElementById('previewSection');
        const loading = document.getElementById('loading');
        const resultSection = document.getElementById('resultSection');
        const altText = document.getElementById('altText');
        const copyBtn = document.getElementById('copyBtn');
        const errorDiv = document.getElementById('error');

        function showError(message) {
            errorDiv.textContent = message;
            errorDiv.classList.add('active');
        }

        function hideError() {
            errorDiv.classList.remove('active');
        }

        imageUrlInput.addEventListener('input', () => {
            const url = imageUrlInput.value.trim();
            if (url) {
                imagePreview.src = url;
                previewSection.classList.add('active');
                hideError();
            } else {
                previewSection.classList.remove('active');
            }
        });

        imagePreview.addEventListener('error', () => {
            showError('Unable to load image. Please check the URL.');
            previewSection.classList.remove('active');
        });

        async function imageUrlToBase64(url) {
            const response = await fetch(url);
            const blob = await response.blob();
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onloadend = () => {
                    const base64String = reader.result.split(',')[1];
                    resolve(base64String);
                };
                reader.onerror = reject;
                reader.readAsDataURL(blob);
            });
        }

        function getImageMediaType(url) {
            const extension = url.split('.').pop().toLowerCase().split('?')[0];
            const mediaTypes = {
                'jpg': 'image/jpeg',
                'jpeg': 'image/jpeg',
                'png': 'image/png',
                'gif': 'image/gif',
                'webp': 'image/webp'
            };
            return mediaTypes[extension] || 'image/jpeg';
        }

        async function generateAltText() {
            const url = imageUrlInput.value.trim();
            
            if (!url) {
                showError('Please enter an image URL');
                return;
            }

            hideError();
            loading.classList.add('active');
            resultSection.classList.remove('active');
            generateBtn.disabled = true;

            try {
                // Convert image URL to base64
                const base64Image = await imageUrlToBase64(url);
                const mediaType = getImageMediaType(url);

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 1000,
                        messages: [{
                            role: 'user',
                            content: [
                                {
                                    type: 'image',
                                    source: {
                                        type: 'base64',
                                        media_type: mediaType,
                                        data: base64Image
                                    }
                                },
                                {
                                    type: 'text',
                                    text: 'Generate a concise, descriptive alt text for this image. The alt text should be clear, specific, and helpful for screen reader users. Keep it under 125 characters if possible. Only provide the alt text without any additional explanation or preamble.'
                                }
                            ]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                const generatedAltText = data.content[0].text.trim();
                
                altText.textContent = generatedAltText;
                resultSection.classList.add('active');
            } catch (error) {
                showError('Failed to generate alt text. Please try again. Make sure the image URL is accessible and CORS-enabled.');
                console.error('Error:', error);
            } finally {
                loading.classList.remove('active');
                generateBtn.disabled = false;
            }
        }

        generateBtn.addEventListener('click', generateAltText);

        imageUrlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                generateAltText();
            }
        });

        clearBtn.addEventListener('click', () => {
            imageUrlInput.value = '';
            previewSection.classList.remove('active');
            resultSection.classList.remove('active');
            hideError();
            copyBtn.textContent = 'Copy to Clipboard';
            copyBtn.classList.remove('copied');
        });

        copyBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(altText.textContent);
                copyBtn.textContent = '‚úì Copied!';
                copyBtn.classList.add('copied');
                setTimeout(() => {
                    copyBtn.textContent = 'Copy to Clipboard';
                    copyBtn.classList.remove('copied');
                }, 2000);
            } catch (error) {
                showError('Failed to copy to clipboard');
            }
        });
    </script>
</body>
</html>