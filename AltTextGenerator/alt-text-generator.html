<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alt Text Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .upload-area {
            border: 3px dashed #e0e0e0;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: #f0f2ff;
        }

        .upload-area.drag-over {
            border-color: #667eea;
            background: #e8ebff;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .upload-text {
            color: #333;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .upload-subtext {
            color: #666;
            font-size: 14px;
        }

        input[type="file"] {
            display: none;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
        }

        button {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .clear-btn {
            background: #f5f5f5;
            color: #333;
        }

        .clear-btn:hover {
            background: #e0e0e0;
        }

        .preview-section {
            margin-bottom: 30px;
            display: none;
        }

        .preview-section.active {
            display: block;
        }

        .image-preview {
            width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
        }

        .result-section {
            display: none;
        }

        .result-section.active {
            display: block;
        }

        .alt-text-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .alt-text-content {
            color: #333;
            line-height: 1.6;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .copy-btn {
            background: #4caf50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
        }

        .copy-btn:hover {
            background: #45a049;
        }

        .copy-btn.copied {
            background: #2196F3;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #c62828;
        }

        .error.active {
            display: block;
        }

        .info-badge {
            display: inline-block;
            background: #e3f2fd;
            color: #1976d2;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üñºÔ∏è Alt Text Generator</h1>
        <p class="subtitle">Upload or paste an image to generate accessible alt text using AI</p>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">üì§</div>
            <div class="upload-text">Click to upload or drag & drop</div>
            <div class="upload-subtext">Or press Ctrl+V (Cmd+V) to paste from clipboard</div>
            <input type="file" id="fileInput" accept="image/*" />
            <div class="info-badge">Supports JPG, PNG, GIF, WebP</div>
        </div>

        <div class="button-group">
            <button class="clear-btn" id="clearBtn">Clear All</button>
        </div>

        <div class="error" id="error"></div>

        <div class="preview-section" id="previewSection">
            <label>Image Preview:</label>
            <img id="imagePreview" class="image-preview" alt="Preview" />
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing image and generating alt text...</p>
        </div>

        <div class="result-section" id="resultSection">
            <label>Generated Alt Text:</label>
            <div class="alt-text-box">
                <div class="alt-text-content" id="altText"></div>
                <button class="copy-btn" id="copyBtn">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <script>
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const clearBtn = document.getElementById('clearBtn');
        const imagePreview = document.getElementById('imagePreview');
        const previewSection = document.getElementById('previewSection');
        const loading = document.getElementById('loading');
        const resultSection = document.getElementById('resultSection');
        const altText = document.getElementById('altText');
        const copyBtn = document.getElementById('copyBtn');
        const errorDiv = document.getElementById('error');

        let currentImageData = null;

        function showError(message) {
            errorDiv.textContent = message;
            errorDiv.classList.add('active');
        }

        function hideError() {
            errorDiv.classList.remove('active');
        }

        // Click to upload
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        // File input change
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                handleImageFile(file);
            }
        });

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('drag-over');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('drag-over');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                handleImageFile(file);
            } else {
                showError('Please drop an image file');
            }
        });

        // Paste from clipboard
        document.addEventListener('paste', (e) => {
            const items = e.clipboardData.items;
            for (let item of items) {
                if (item.type.startsWith('image/')) {
                    const file = item.getAsFile();
                    handleImageFile(file);
                    break;
                }
            }
        });

        async function handleImageFile(file) {
            hideError();
            
            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                imagePreview.src = e.target.result;
                previewSection.classList.add('active');
                currentImageData = e.target.result;
                
                // Auto-generate alt text
                generateAltText();
            };
            reader.readAsDataURL(file);
        }

        function getImageMediaType(base64String) {
            if (base64String.startsWith('data:image/png')) return 'image/png';
            if (base64String.startsWith('data:image/gif')) return 'image/gif';
            if (base64String.startsWith('data:image/webp')) return 'image/webp';
            return 'image/jpeg';
        }

        async function generateAltText() {
            if (!currentImageData) {
                showError('Please upload or paste an image first');
                return;
            }

            hideError();
            loading.classList.add('active');
            resultSection.classList.remove('active');

            try {
                // Extract base64 data without the data URL prefix
                const base64Data = currentImageData.split(',')[1];
                const mediaType = getImageMediaType(currentImageData);

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 1000,
                        messages: [{
                            role: 'user',
                            content: [
                                {
                                    type: 'image',
                                    source: {
                                        type: 'base64',
                                        media_type: mediaType,
                                        data: base64Data
                                    }
                                },
                                {
                                    type: 'text',
                                    text: 'Generate a concise, descriptive alt text for this image. The alt text should be clear, specific, and helpful for screen reader users. Keep it under 125 characters if possible. Only provide the alt text without any additional explanation or preamble.'
                                }
                            ]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                const generatedAltText = data.content[0].text.trim();
                
                altText.textContent = generatedAltText;
                resultSection.classList.add('active');
            } catch (error) {
                showError('Failed to generate alt text. Please try again.');
                console.error('Error:', error);
            } finally {
                loading.classList.remove('active');
            }
        }

        clearBtn.addEventListener('click', () => {
            fileInput.value = '';
            currentImageData = null;
            previewSection.classList.remove('active');
            resultSection.classList.remove('active');
            hideError();
            copyBtn.textContent = 'Copy to Clipboard';
            copyBtn.classList.remove('copied');
        });

        copyBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(altText.textContent);
                copyBtn.textContent = '‚úì Copied!';
                copyBtn.classList.add('copied');
                setTimeout(() => {
                    copyBtn.textContent = 'Copy to Clipboard';
                    copyBtn.classList.remove('copied');
                }, 2000);
            } catch (error) {
                showError('Failed to copy to clipboard');
            }
        });
    </script>
</body>
</html>